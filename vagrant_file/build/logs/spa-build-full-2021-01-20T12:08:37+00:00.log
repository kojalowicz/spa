+ build
+ cd /home/vagrant
+ git clone -b improvement-separate-machines https://github.com/kojalowicz/spa.git
Cloning into 'spa'...
+ . /home/vagrant/spa/scripts/docker_deamon.sh
++ set -o pipefail
++ set_up_docker
+++ date --iso-8601=seconds
++ tee /home/vagrant/logs/spa-set_up_dockerr-2021-01-20T12:08:39+00:00.log
++ cp /home/vagrant/daemon.json /etc/docker/daemon.json
++ systemctl restart docker.socket
++ systemctl restart docker
+ cd /home/vagrant/spa/app
+ npm install

> core-js@3.6.4 postinstall /home/vagrant/spa/app/node_modules/core-js
> node -e "try{require('./postinstall')}catch(e){}"

[96mThank you for using core-js ([94m https://github.com/zloirock/core-js [96m) for polyfilling JavaScript standard library![0m

[96mThe project needs your help! Please consider supporting of core-js on Open Collective or Patreon: [0m
[96m>[94m https://opencollective.com/core-js [0m
[96m>[94m https://www.patreon.com/zloirock [0m

[96mAlso, the author of core-js ([94m https://github.com/zloirock [96m) is looking for a good job -)[0m


> @angular/cli@9.1.0 postinstall /home/vagrant/spa/app/node_modules/@angular/cli
> node ./bin/postinstall/script.js

npm WARN optional SKIPPING OPTIONAL DEPENDENCY: fsevents@1.2.12 (node_modules/webpack-dev-server/node_modules/fsevents):
npm WARN notsup SKIPPING OPTIONAL DEPENDENCY: Unsupported platform for fsevents@1.2.12: wanted {"os":"darwin","arch":"any"} (current: {"os":"linux","arch":"x64"})
npm WARN optional SKIPPING OPTIONAL DEPENDENCY: fsevents@1.2.12 (node_modules/watchpack/node_modules/fsevents):
npm WARN notsup SKIPPING OPTIONAL DEPENDENCY: Unsupported platform for fsevents@1.2.12: wanted {"os":"darwin","arch":"any"} (current: {"os":"linux","arch":"x64"})
npm WARN optional SKIPPING OPTIONAL DEPENDENCY: fsevents@2.1.2 (node_modules/fsevents):
npm WARN notsup SKIPPING OPTIONAL DEPENDENCY: Unsupported platform for fsevents@2.1.2: wanted {"os":"darwin","arch":"any"} (current: {"os":"linux","arch":"x64"})

added 1383 packages from 1122 contributors and audited 1521 packages in 29.887s

47 packages are looking for funding
  run `npm fund` for details

found 322 vulnerabilities (314 low, 8 high)
  run `npm audit fix` to fix them, or `npm audit` for details
+ npm run build

> hello-spa@0.0.0 build /home/vagrant/spa/app
> ng build

Compiling @angular/animations : es2015 as esm2015
Compiling @angular/core : es2015 as esm2015
Compiling @angular/animations/browser : es2015 as esm2015
Compiling @angular/animations/browser/testing : es2015 as esm2015
Compiling @angular/common : es2015 as esm2015
Compiling @angular/common/http : es2015 as esm2015
Compiling @angular/common/http/testing : es2015 as esm2015
Compiling @angular/forms : es2015 as esm2015
Compiling @angular/platform-browser : es2015 as esm2015
Compiling @angular/platform-browser/animations : es2015 as esm2015
Compiling @angular/core/testing : es2015 as esm2015
Compiling @angular/platform-browser-dynamic : es2015 as esm2015
Compiling @angular/platform-browser/testing : es2015 as esm2015
Compiling @angular/compiler/testing : es2015 as esm2015
Compiling @angular/platform-browser-dynamic/testing : es2015 as esm2015
Compiling @angular/common/testing : es2015 as esm2015
Compiling @angular/router : es2015 as esm2015
Compiling @angular/router/testing : es2015 as esm2015
Generating ES5 bundles for differential loading...
ES5 bundle generation complete.

chunk {polyfills} polyfills-es2015.js, polyfills-es2015.js.map (polyfills) 141 kB [initial] [rendered]
chunk {main} main-es2015.js, main-es2015.js.map (main) 21.1 kB [initial] [rendered]
chunk {main} main-es5.js, main-es5.js.map (main) 22.5 kB [initial] [rendered]
chunk {runtime} runtime-es2015.js, runtime-es2015.js.map (runtime) 6.16 kB [entry] [rendered]
chunk {runtime} runtime-es5.js, runtime-es5.js.map (runtime) 6.16 kB [entry] [rendered]
chunk {styles} styles-es2015.js, styles-es2015.js.map (styles) 9.76 kB [initial] [rendered]
chunk {styles} styles-es5.js, styles-es5.js.map (styles) 10.9 kB [initial] [rendered]
chunk {polyfills-es5} polyfills-es5.js, polyfills-es5.js.map (polyfills-es5) 656 kB [initial] [rendered]
chunk {vendor} vendor-es2015.js, vendor-es2015.js.map (vendor) 2.66 MB [initial] [rendered]
chunk {vendor} vendor-es5.js, vendor-es5.js.map (vendor) 3.12 MB [initial] [rendered]
Date: 2021-01-20T12:10:18.086Z - Hash: b1b48fe3d39d7fe50647 - Time: 61536ms
+ . /home/vagrant/spa/scripts/tests.sh build
++ what_to_test=build
++ . /home/vagrant/env.conf
+++ git_clone_commend='-b improvement-separate-machines https://github.com/kojalowicz/spa.git'
+++ work_dir=/home/vagrant/spa
+++ logs_dir=/home/vagrant/logs
+++ project_name=spa
+++ source_code_location=app
+++ project_version=0.1
+++ registry_name=registry
+++ registry_url=192.168.10.12
+++ registry_port=5000
+++ docker_port_host=8080
+++ docker_port_guest=80
++ set -o pipefail
++ [[ build == \b\u\i\l\d ]]
++ build_test
+++ date --iso-8601=seconds
++ tee /home/vagrant/logs/spa-build-test-2021-01-20T12:10:18+00:00.log
++ set -o pipefail
++ cd /home/vagrant/spa/app
++ ng e2e
Your global Angular CLI version (11.0.7) is greater than your local version (9.1.0). The local Angular CLI version is used.

To disable this warning use "ng config -g cli.warnings.versionMismatch false".
[12:10:21] I/file_manager - creating folder /home/vagrant/spa/app/node_modules/protractor/node_modules/webdriver-manager/selenium
[12:10:21] I/config_source - curl -o/home/vagrant/spa/app/node_modules/protractor/node_modules/webdriver-manager/selenium/chrome-response.xml https://chromedriver.storage.googleapis.com/
[12:10:22] I/downloader - curl -o/home/vagrant/spa/app/node_modules/protractor/node_modules/webdriver-manager/selenium/chromedriver_87.0.4280.88.zip https://chromedriver.storage.googleapis.com/87.0.4280.88/chromedriver_linux64.zip
[12:10:23] I/update - chromedriver: unzipping chromedriver_87.0.4280.88.zip
[12:10:23] I/update - chromedriver: setting permissions to 0755 for /home/vagrant/spa/app/node_modules/protractor/node_modules/webdriver-manager/selenium/chromedriver_87.0.4280.88

chunk {main} main.js, main.js.map (main) 22.5 kB [initial] [rendered]
chunk {polyfills} polyfills.js, polyfills.js.map (polyfills) 141 kB [initial] [rendered]
chunk {runtime} runtime.js, runtime.js.map (runtime) 6.15 kB [entry] [rendered]
chunk {styles} styles.js, styles.js.map (styles) 9.75 kB [initial] [rendered]
chunk {vendor} vendor.js, vendor.js.map (vendor) 2.99 MB [initial] [rendered]
Date: 2021-01-20T12:10:39.886Z - Hash: ab5b7b09d52eb1a8d33c - Time: 9178ms
** Angular Live Development Server is listening on localhost:4200, open your browser on http://localhost:4200/ **
: Compiled successfully.
[12:10:40] I/launcher - Running 1 instances of WebDriver
[12:10:40] I/direct - Using ChromeDriver directly...
Jasmine started

  workspace-project App
    [32mâœ“ should display welcome message[39m

Executed 1 of 1 spec[32m SUCCESS[39m in 1 sec.
[12:10:45] I/launcher - 0 instance(s) of WebDriver still running
[12:10:45] I/launcher - chrome #01 passed
+ cd /home/vagrant/spa
+ docker build -t 192.168.10.12:5000/spa:0.1 .
Sending build context to Docker daemon  428.7MB
Step 1/3 : FROM nginx:1.17.1-alpine
1.17.1-alpine: Pulling from library/nginx
e7c96db7181b: Pulling fs layer
3fb6217217ef: Pulling fs layer
e7c96db7181b: Verifying Checksum
e7c96db7181b: Download complete
3fb6217217ef: Verifying Checksum
3fb6217217ef: Download complete
e7c96db7181b: Pull complete
3fb6217217ef: Pull complete
Digest: sha256:17bd1698318e9c0f9ba2c5ed49f53d690684dab7fe3e8019b855c352528d57be
Status: Downloaded newer image for nginx:1.17.1-alpine
 ---> ea1193fd3dde
Step 2/3 : COPY ./configuration/nginx.conf /etc/nginx/nginx.conf
 ---> f9b72546e029
Step 3/3 : COPY ./app/dist/hello-spa/ /usr/share/nginx/html/
 ---> df387f933320
Successfully built df387f933320
Successfully tagged 192.168.10.12:5000/spa:0.1
+ . /home/vagrant/spa/scripts/tests.sh container
++ what_to_test=container
++ . /home/vagrant/env.conf
+++ git_clone_commend='-b improvement-separate-machines https://github.com/kojalowicz/spa.git'
+++ work_dir=/home/vagrant/spa
+++ logs_dir=/home/vagrant/logs
+++ project_name=spa
+++ source_code_location=app
+++ project_version=0.1
+++ registry_name=registry
+++ registry_url=192.168.10.12
+++ registry_port=5000
+++ docker_port_host=8080
+++ docker_port_guest=80
++ set -o pipefail
++ [[ container == \b\u\i\l\d ]]
++ [[ container == \c\o\n\t\a\i\n\e\r ]]
++ container_test
+++ date --iso-8601=seconds
++ tee /home/vagrant/logs/spa-container-test-2021-01-20T12:11:14+00:00.log
++ docker run -it --name spa -d -p 8080:80 192.168.10.12:5000/spa:0.1
6af060d5abef670251da4256f8e11d6865965071fbbe811fe395afc56c1eeacd
++ grep -w '200\|301'
++ curl -I localhost:8080
HTTP/1.1 200 OK
++ echo 'Test it docker is up - OK, good job :D!'
Test it docker is up - OK, good job :D!
++ docker stop spa
spa
++ docker rm spa
spa
+ docker_push
+ docker push 192.168.10.12:5000/spa:0.1
The push refers to repository [192.168.10.12:5000/spa]
e117ed8455d4: Preparing
b8995168e6b8: Preparing
fbe0fc9bcf95: Preparing
f1b5933fe4b5: Preparing
b8995168e6b8: Pushed
e117ed8455d4: Pushed
f1b5933fe4b5: Pushed
fbe0fc9bcf95: Pushed
0.1: digest: sha256:225e48bb5bb72ef9d7ee726156455f0956654d9d0ec103e80abf9d7b39e24f28 size: 1157
